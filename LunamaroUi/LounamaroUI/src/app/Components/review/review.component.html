<div class="review-page">

  <!-- ===== ADD REVIEW (CUSTOMER ONLY) ===== -->
  <div class="add-review-card" *ngIf="role === 'Customer'">
    <h2>Leave a Review</h2>

    <!-- Stars Input -->
    <div class="stars">
      <span
        *ngFor="let s of [1,2,3,4,5]"
        (click)="setRating(s)"
        [class.active]="s <= newReview.Rating">
        ★
      </span>
    </div>

    <textarea
      [(ngModel)]="newReview.Content"
      placeholder="Write your review..."
      rows="4">
    </textarea>

    <button (click)="submitReview()">Submit Review</button>
  </div>

  <!-- ===== ALL REVIEWS ===== -->
  <div class="reviews-section" *ngIf="reviewsData">
    <h2>Customer Reviews</h2>

    <!-- AVG INFO -->
    <div class="avg-info">
      <span class="big-stars">⭐ {{ reviewsData.averageRating }}</span>
      <span>{{ reviewsData.totalReviews }} reviews</span>
    </div>

    <!-- REVIEW LIST -->
    <div class="review-list">

      <div class="review-item" *ngFor="let r of reviewsData.reviews">

        <!-- Avatar -->
        <div class="avatar"
             [style.background-color]="getAvatarColor(r.name)">
          {{ getInitials(r.name) }}
        </div>

        <!-- Body -->
        <div class="review-body">

          <div class="review-top">
            <strong class="review-name">{{ r.name }}</strong>

            <span class="stars-display">
              <span *ngFor="let s of [1,2,3,4,5]"
                    [class.filled]="s <= r.rating">
                ★
              </span>
            </span>
          </div>

          <p class="content">{{ r.content }}</p>

          <small class="date">
            {{ r.createdAt | date:'mediumDate' }}
          </small>

          <!-- ADMIN ACTION -->
          <div class="admin-actions" *ngIf="role === 'Admin'">
            <button class="delete-btn"
                    (click)="deleteReview(r.rating)">
              Delete
            </button>
          </div>

        </div>
      </div>

    </div>
  </div>

</div>
